msg01	db 0Dh,0Ah,"Digite o endereco: ", 0
msg02   db 0Dh,0Ah,"<ESC>para novo segment <Enter>continua ES: ", 0
msg03   db 0Dh,0Ah,"Novo segment ES: ", 0


inputAddress:
        call readLine
        call convertWordToHex
	mov 	ah, byte es:[buff_write]
	mov	al, byte es:[buff_write+1]
        ret

loadBX:
        push    ES
        mov     AX, 0x0
        mov     ES, AX
        mov     si, msg01
        call    pstr
        call    inputAddress
        mov     BX, AX
        ;call    print_hex
        pop     ES
        ret        
showES:
        push BX
        mov  si, msg02
        call pstr
        mov  AX, ES
        call print_hex
        XOR  AX, AX
        call cin_blct
        cmp  al, 0x0d
        je   .retorna
        call    changeES
.retorna:
        pop BX
        ret

changeES:
        push    BX
        xor     AX, AX
        mov     ES, AX
        mov     si, msg03
        call    pstr
        call    inputAddress
        mov     ES, AX
        pop     BX
        ret

;Return the address in: ES:BX
readAddress:
        call    showES
        call    loadBX
        ret

readByteHexX:
        clc
        call cin_blct
        cmp  al, 0x1b
        je   readByteHexEnd   
        call to_hex
        mov  ah, al
        call print_digit
        call cin_blct
        cmp  al, 0x1b
        je   readByteHexEnd   
        call to_hex
        shl  ah, 1
        shl  ah, 1
        shl  ah, 1
        shl  ah, 1
        or   al, ah
        call  print_digit
        stc
readByteHexEnd:        
        ret          


;Return byte in hexadecmal in: AL
inputData:
        call readLine
        call convertByteToHex
        mov  al, byte es:[buff_write]
        ret
           
;;;****************************************************************
;;; TESTES
;;;****************************************************************

sector1bkp db 0xFA,0x33,0xC0,0x8E,0xD0,0xBC,0x00,0x7C,0x8B,0xF4,0x50,0x07,0x50,0x1F,0xFB,0xFC 
        db 0xBF,0x00,0x06,0xB9,0x00,0x01,0xF2,0xA5,0xEA,0x1D,0x06,0x00,0x00,0xBE,0xBE,0x07 
        db 0xB3,0x04,0x80,0x3C,0x80,0x74,0x0E,0x80,0x3C,0x00,0x75,0x1C,0x83,0xC6,0x10,0xFE 
        db 0xCB,0x75,0xEF,0xCD,0x18,0x8B,0x14,0x8B,0x4C,0x02,0x8B,0xEE,0x83,0xC6,0x10,0xFE 
        db 0xCB,0x74,0x1A,0x80,0x3C,0x00,0x74,0xF4,0xBE,0x8B,0x06,0xAC,0x3C,0x00,0x74,0x0B
        db 0x56,0xBB,0x07,0x00,0xB4,0x0E,0xCD,0x10,0x5E,0xEB,0xF0,0xEB,0xFE,0xBF,0x05,0x00
        db 0xBB,0x00,0x7C,0xB8,0x01,0x02,0x57,0xCD,0x13,0x5F,0x73,0x0C,0x33,0xC0,0xCD,0x13
        db 0x4F,0x75,0xED,0xBE,0xA3,0x06,0xEB,0xD3,0xBE,0xC2,0x06,0xBF,0xFE,0x7D,0x81,0x3D
        db 0x55,0xAA,0x75,0xC7,0x8B,0xF5,0xEA,0x00,0x7C,0x00,0x00,0x49,0x6E,0x76,0x61,0x6C
        db 0x69,0x64,0x20,0x70,0x61,0x72,0x74,0x69,0x74,0x69,0x6F,0x6E,0x20,0x74,0x61,0x62
        db 0x6C,0x65,0x00,0x45,0x72,0x72,0x6F,0x72,0x20,0x6C,0x6F,0x61,0x64,0x69,0x6E,0x67
        db 0x20,0x6F,0x70,0x65,0x72,0x61,0x74,0x69,0x6E,0x67,0x20,0x73,0x79,0x73,0x74,0x65
        db 0x6D,0x00,0x4D,0x69,0x73,0x73,0x69,0x6E,0x67,0x20,0x6F,0x70,0x65,0x72,0x61,0x74
        db 0x69,0x6E,0x67,0x20,0x73,0x79,0x73,0x74,0x65,0x6D,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01
        db 0x01,0x00,0x0B,0x7F,0xBF,0xFD,0x3F,0x00,0x00,0x00,0xC1,0x40,0x5E,0x00,0x00,0x00 
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 
        db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x55,0xAA 

sector11  db 0xfc,0xbb,0x14,0x7c,0xb4,0x10,0xcd,0x10,0xb8,0x00,0xf0,0x8e,0xd8,0x8e,0xc8,0xea
         db 0x9e,0xd0,0x00,0xf0,0x0d,0x0a,0x42,0x6f,0x6f,0x74,0x20,0x72,0x65,0x63,0x6f,0x72
         db 0x64,0x20,0x6c,0x6f,0x61,0x64,0x65,0x64,0x20,0x66,0x72,0x6f,0x6d,0x20,0x70,0x65
         db 0x6e,0x64,0x72,0x69,0x76,0x65,0x2e,0x0d,0x0a,0x52,0x65,0x74,0x75,0x72,0x6e,0x69
         db 0x6e,0x67,0x20,0x74,0x6f,0x20,0x6d,0x6f,0x6e,0x69,0x74,0x6f,0x72,0x2e,0x00,0xff
         db 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff


sector1  db 0xfc,0xbb,0x0d,0x7c,0xb4,0x10,0xcd,0x10,0xea,0x00,0xd0,0x00,0xf0,0x0d,0x0a,0x42
         db 0x6f,0x6f,0x74,0x20,0x72,0x65,0x63,0x6f,0x72,0x64,0x20,0x6c,0x6f,0x61,0x64,0x65
         db 0x64,0x20,0x66,0x72,0x6f,0x6d,0x20,0x70,0x65,0x6e,0x64,0x72,0x69,0x76,0x65,0x2e
         db 0x0d,0x0a,0x52,0x65,0x74,0x75,0x72,0x6e,0x69,0x6e,0x67,0x20,0x74,0x6f,0x20,0x6d
         db 0x6f,0x6e,0x69,0x74,0x6f,0x72,0x2e,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
         db 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01
         db 0x01,0x00,0x0b,0x7f,0xbf,0xfd,0x3f,0x00,0x00,0x00,0xc1,0x40,0x5e,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
         db 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x55,0xaa

;00000000  0xfc,0xbb,0x09,0x7c,0xb4,0x10,0xcd,0x0a,0xc3,0x0d,0x0a,0x42,0x6f,0x6f,0x74,0x20
;00000010  0x72,0x65,0x63,0x6f,0x72,0x64,0x20,0x6c,0x6f,0x61,0x64,0x65,0x64,0x20,0x66,0x72
;00000020  0x6f,0x6d,0x20,0x70,0x65,0x6e,0x64,0x72,0x69,0x76,0x65,0x2e,0x00,0x0d,0x0a,0x52
;00000030  0x65,0x74,0x75,0x72,0x6e,0x69,0x6e,0x67,0x20,0x74,0x6f,0x20,0x6d,0x6f,0x6e,0x69
;00000040  0x74,0x6f,0x72,0x2e,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
;00000050  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
;00000060  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000070  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000080  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000090  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000000A0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000000B0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000000C0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000000D0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000000E0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000000F0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000100  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000110  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000120  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000130  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000140  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000150  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000160  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000170  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000180  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;00000190  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000001A0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000001b0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01
;000001c0  0x01,0x00,0x0b,0x7f,0xbf,0xfd,0x3f,0x00,0x00,0x00,0xc1,0x40,0x5e,0x00,0x00,0x00
;000001d0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000001e0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
;000001f0  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x55,0xaa
;

